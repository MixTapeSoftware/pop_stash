<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PopStash MCP Server</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        line-height: 1.6;
        max-width: 900px;
        margin: 0 auto;
        padding: 40px 20px;
        background: #ffffff;
        color: #1a1a1a;
      }

      h1 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        color: #1a1a1a;
      }

      h2 {
        font-size: 1.5rem;
        font-weight: 600;
        margin-top: 2rem;
        margin-bottom: 1rem;
        color: #1a1a1a;
        border-bottom: 2px solid #e5e5e5;
        padding-bottom: 0.5rem;
      }

      p {
        margin-bottom: 1rem;
        color: #4a4a4a;
      }

      code {
        background: #f5f5f5;
        padding: 2px 8px;
        border-radius: 4px;
        font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Courier New', monospace;
        font-size: 0.9em;
        color: #d63384;
        border: 1px solid #e5e5e5;
      }

      pre {
        background: #1a1a1a;
        color: #f5f5f5;
        padding: 16px;
        border-radius: 8px;
        overflow-x: auto;
        margin: 1rem 0;
        border: 1px solid #333;
      }

      pre code {
        background: transparent;
        padding: 0;
        border: none;
        color: #f5f5f5;
        font-size: 0.85rem;
      }

      .note {
        background: #fff3cd;
        border: 2px solid #ffc107;
        border-radius: 8px;
        padding: 16px;
        margin: 1.5rem 0;
      }

      .note strong {
        color: #856404;
        display: block;
        margin-bottom: 0.5rem;
      }

      .note p {
        color: #856404;
        margin: 0;
      }

      ul {
        list-style: none;
        padding: 0;
      }

      ul li {
        padding: 12px;
        margin: 8px 0;
        background: #f8f9fa;
        border-radius: 6px;
        border-left: 4px solid #0066cc;
      }

      ul li code {
        background: #e9ecef;
        color: #1a1a1a;
        font-weight: 600;
      }

      ul li b {
        color: #1a1a1a;
        font-weight: 600;
      }

      .projects-list {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 16px;
        margin: 1rem 0;
      }

      .projects-list li {
        background: #ffffff;
        border: 1px solid #dee2e6;
        border-left: 4px solid #28a745;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .project-id {
        font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
        font-size: 0.85rem;
        color: #0066cc;
        font-weight: 600;
      }

      .project-name {
        color: #4a4a4a;
        font-weight: 500;
      }

      .empty-state {
        font-style: italic;
        color: #6c757d;
        padding: 16px;
        text-align: center;
        background: #f8f9fa;
        border-radius: 6px;
        margin: 1rem 0;
      }

      .count {
        color: #6c757d;
        font-weight: 400;
        font-size: 0.9em;
      }

      @media (prefers-color-scheme: dark) {
        body {
          background: #1a1a1a;
          color: #e5e5e5;
        }

        h1, h2 {
          color: #f5f5f5;
        }

        h2 {
          border-bottom-color: #333;
        }

        p {
          color: #b5b5b5;
        }

        code {
          background: #2a2a2a;
          color: #ff6b6b;
          border-color: #333;
        }

        pre {
          background: #0d0d0d;
          border-color: #000;
        }

        ul li {
          background: #2a2a2a;
          border-left-color: #4da6ff;
        }

        ul li code {
          background: #1a1a1a;
          color: #f5f5f5;
        }

        ul li b {
          color: #f5f5f5;
        }

        .projects-list {
          background: #2a2a2a;
        }

        .projects-list li {
          background: #1a1a1a;
          border-color: #333;
          border-left-color: #28a745;
        }

        .project-id {
          color: #4da6ff;
        }

        .project-name {
          color: #b5b5b5;
        }

        .empty-state {
          background: #2a2a2a;
          color: #6c757d;
        }
      }
    </style>
  </head>
  <body>
    <h1>PopStash MCP Server</h1>
    <p>POST JSON-RPC 2.0 to <code>/mcp/:project_id</code></p>

    <div class="note">
      <strong>Project ID Required</strong>
      <p>
        Each workspace needs its own project ID in the URL. Create one with:
        <code>bin/init "My Project"</code>
      </p>
    </div>

    <h2>Projects <span class="count">({length(@projects)})</span></h2>
    <%= if @projects == [] do %>
      <div class="empty-state">
        No projects yet. Create one with <code>bin/init "My Project"</code>
      </div>
    <% else %>
      <ul class="projects-list">
        <%= for p <- @projects do %>
          <li>
            <span class="project-id">{p.id}</span>
            <span class="project-name">{p.name}</span>
          </li>
        <% end %>
      </ul>
    <% end %>

    <h2>Tools <span class="count">({length(@tools)})</span></h2>
    <ul>
      <%= for t <- @tools do %>
        <li><b>{t.name}</b> â€” {t.description}</li>
      <% end %>
    </ul>

    <h2>Claude Code Setup</h2>
    <p>Add to your workspace <code>.mcp.json</code>:</p>
    <pre phx-no-curly-interpolation><code>{
  "pop_stash": {
    "url": "http://localhost:<%= @port %>/mcp/YOUR_PROJECT_ID"
  }
}</code></pre>
  </body>
</html>
